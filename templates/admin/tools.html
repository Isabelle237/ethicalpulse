
{% extends 'admin/admin_base.html' %}

{% block title %}Outils de Sécurité - Ethical Pulse Shield{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row mb-4">
        <div class="col">
            <h1 class="h2 mb-2">Outils de Sécurité</h1>
            <p class="text-muted">Interface centralisée pour les outils de tests d'intrusion et d'analyse de sécurité</p>
        </div>
    </div>

    <!-- Tool Categories -->
    <div class="row mb-4">
        <div class="col">
            <div class="btn-group" role="group" aria-label="Catégories d'outils">
                <button type="button" class="btn btn-outline-primary active" data-category="all">Tous</button>
                <button type="button" class="btn btn-outline-primary" data-category="reconnaissance">Reconnaissance</button>
                <button type="button" class="btn btn-outline-primary" data-category="scanner">Scanners</button>
                <button type="button" class="btn btn-outline-primary" data-category="exploitation">Exploitation</button>
                <button type="button" class="btn btn-outline-primary" data-category="password">Mot de passe</button>
                <button type="button" class="btn btn-outline-primary" data-category="wireless">Sans Fil</button>
                <button type="button" class="btn btn-outline-primary" data-category="web">Web</button>
                <button type="button" class="btn btn-outline-primary" data-category="reverse">Rétro-Ingénierie</button>
                <button type="button" class="btn btn-outline-primary" data-category="persistence">Post-Exploitation</button>
            </div>
        </div>
    </div>

    <!-- Search Tool -->
    <div class="row mb-4">
        <div class="col-md-6">
            <div class="input-group">
                <span class="input-group-text bg-white">
                    <i class="bi bi-search"></i>
                </span>
                <input type="search" id="toolSearch" class="form-control" placeholder="Rechercher un outil...">
            </div>
        </div>
    </div>

    <!-- Tools List -->
    <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4 mb-4" id="toolsList">
        <!-- Nmap Tool -->
        <div class="col tool-item" data-category="scanner">
            <div class="card h-100">
                <div class="card-header bg-dark text-white d-flex justify-content-between">
                    <div>
                        <i class="bi bi-search me-2"></i>
                        <strong>Nmap</strong>
                    </div>
                    <span class="badge bg-info">Scanner</span>
                </div>
                <div class="card-body">
                    <p class="card-text small">Scanner réseau puissant pour la découverte d'hôtes, services et vulnérabilités.</p>
                    <div class="mb-3">
                        <label class="form-label fw-bold small">Options:</label>
                        <select class="form-select form-select-sm tool-option" data-tool="nmap">
                            {% for value, label in nmap_options %}
                            <option value="{{ value }}">{{ label }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold small">Cible:</label>
                        <input type="text" class="form-control form-control-sm tool-target" placeholder="IP ou domaine (ex: 192.168.1.1)" data-tool="nmap">
                    </div>
                    <div class="d-grid gap-2">
                        <button class="btn btn-primary btn-sm run-tool" data-tool="nmap">
                            <i class="bi bi-play-fill me-1"></i>Exécuter
                        </button>
                        <button class="btn btn-outline-secondary btn-sm tool-doc-btn" data-bs-toggle="collapse" data-bs-target="#nmapDoc" aria-expanded="false">
                            <i class="bi bi-file-text me-1"></i>Documentation
                        </button>
                    </div>
                    <div class="collapse mt-3" id="nmapDoc">
                        <div class="card card-body bg-light small">
                            <h6>Documentation Nmap</h6>
                            <p>Nmap (Network Mapper) est un scanner de sécurité open source utilisé pour découvrir des hôtes et services sur un réseau informatique.</p>
                            <p><strong>Utilisations principales:</strong></p>
                            <ul>
                                <li>Découverte d'hôtes actifs</li>
                                <li>Identification des ports ouverts</li>
                                <li>Détection des systèmes d'exploitation</li>
                                <li>Détection des services et versions</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Nikto Tool -->
            <div class="col tool-item" data-category="web">
                <div class="card h-100">
                    <div class="card-header bg-dark text-white d-flex justify-content-between">
                        <div>
                            <i class="bi bi-globe me-2"></i>
                            <strong>Nikto</strong>
                        </div>
                        <span class="badge bg-primary">Web</span>
                    </div>
                    <div class="card-body">
                        <p class="card-text small">Scanner de vulnérabilités web qui effectue des tests complets contre des serveurs web.</p>
                        <form method="post" action="{% url 'tools_admin' %}" class="mb-3">
                            {% csrf_token %}
                            <div class="mb-3">
                                <label class="form-label fw-bold small">Options:</label>
                                <select class="form-select form-select-sm" name="option" required>
                                    {% for value, label in nikto_options %}
                                    <option value="{{ value }}">{{ label }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="form-label fw-bold small">Cible:</label>
                                <select class="form-select form-select-sm" name="project_id" required>
                                    {% for project in projects %}
                                    <option value="{{ project.id }}">
                                        {{ project.name }} — 
                                        {% if project.url %}{{ project.url }}{% else %}{{ project.ip_address }}{% endif %}
                                    </option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="d-grid gap-2">
                                <button type="submit" class="btn btn-primary btn-sm">
                                    <i class="bi bi-play-fill me-1"></i>Exécuter
                                </button>
                                <button type="button" class="btn btn-outline-secondary btn-sm tool-doc-btn" data-bs-toggle="collapse" data-bs-target="#niktoDoc" aria-expanded="false">
                                    <i class="bi bi-file-text me-1"></i>Documentation
                                </button>
                            </div>
                            <div class="collapse mt-3" id="niktoDoc">
                                <div class="card card-body bg-light small">
                                    <h6>Documentation Nikto</h6>
                                    <p>Nikto est un scanner de vulnérabilités open source qui effectue des tests complets contre des serveurs web.</p>
                                    <p><strong>Fonctionnalités:</strong></p>
                                    <ul>
                                        <li>Détection de fichiers/CGI vulnérables</li>
                                        <li>Vérification des serveurs obsolètes</li>
                                        <li>Scans de configuration</li>
                                        <li>Tests d'injection</li>
                                    </ul>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

        <!-- SQLMap Tool -->
        <div class="col tool-item" data-category="web">
            <div class="card h-100">
                <div class="card-header bg-dark text-white d-flex justify-content-between">
                    <div>
                        <i class="bi bi-database me-2"></i>
                        <strong>SQLMap</strong>
                    </div>
                    <span class="badge bg-primary">Web</span>
                </div>
                <div class="card-body">
                    <p class="card-text small">Outil de test de pénétration automatisant la détection et l'exploitation des vulnérabilités d'injection SQL.</p>
                    <div class="mb-3">
                        <label class="form-label fw-bold small">Options:</label>
                        <select class="form-select form-select-sm tool-option" data-tool="sqlmap">
                            {% for value, label in sqlmap_options %}
                            <option value="{{ value }}">{{ label }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold small">Cible:</label>
                        <input type="text" class="form-control form-control-sm tool-target" placeholder="URL (ex: http://example.com/page.php?id=1)" data-tool="sqlmap">
                    </div>
                    <div class="d-grid gap-2">
                        <button class="btn btn-primary btn-sm run-tool" data-tool="sqlmap">
                            <i class="bi bi-play-fill me-1"></i>Exécuter
                        </button>
                        <button class="btn btn-outline-secondary btn-sm tool-doc-btn" data-bs-toggle="collapse" data-bs-target="#sqlmapDoc" aria-expanded="false">
                            <i class="bi bi-file-text me-1"></i>Documentation
                        </button>
                    </div>
                    <div class="collapse mt-3" id="sqlmapDoc">
                        <div class="card card-body bg-light small">
                            <h6>Documentation SQLMap</h6>
                            <p>SQLMap est un outil open source de test de pénétration qui automatise la détection et l'exploitation d'injection SQL.</p>
                            <p><strong>Fonctionnalités:</strong></p>
                            <ul>
                                <li>Support de multiples types de SGBD</li>
                                <li>Détection et exploitation automatiques</li>
                                <li>Extraction de données de base de données</li>
                                <li>Accès au système de fichiers</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Netcat Tool -->
        <div class="col tool-item" data-category="exploitation">
            <div class="card h-100">
                <div class="card-header bg-dark text-white d-flex justify-content-between">
                    <div>
                        <i class="bi bi-terminal me-2"></i>
                        <strong>Netcat</strong>
                    </div>
                    <span class="badge bg-danger">Exploitation</span>
                </div>
                <div class="card-body">
                    <p class="card-text small">Utilitaire réseau pour lire/écrire des données via des connexions TCP ou UDP.</p>
                    <div class="mb-3">
                        <label class="form-label fw-bold small">Options:</label>
                        <select class="form-select form-select-sm tool-option" data-tool="netcat">
                            {% for value, label in netcat_options %}
                            <option value="{{ value }}">{{ label }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold small">Port/Cible:</label>
                        <input type="text" class="form-control form-control-sm tool-target" placeholder="IP:port (ex: 192.168.1.1 4444)" data-tool="netcat">
                    </div>
                    <div class="d-grid gap-2">
                        <button class="btn btn-primary btn-sm run-tool" data-tool="netcat">
                            <i class="bi bi-play-fill me-1"></i>Exécuter
                        </button>
                        <button class="btn btn-outline-secondary btn-sm tool-doc-btn" data-bs-toggle="collapse" data-bs-target="#netcatDoc" aria-expanded="false">
                            <i class="bi bi-file-text me-1"></i>Documentation
                        </button>
                    </div>
                    <div class="collapse mt-3" id="netcatDoc">
                        <div class="card card-body bg-light small">
                            <h6>Documentation Netcat</h6>
                            <p>Netcat est souvent décrit comme le "couteau suisse" des outils réseau. C'est un utilitaire simple qui lit et écrit des données via des connexions réseau TCP ou UDP.</p>
                            <p><strong>Utilisations communes:</strong></p>
                            <ul>
                                <li>Transfert de fichiers</li>
                                <li>Scanning de port</li>
                                <li>Création de serveurs d'écoute</li>
                                <li>Reverse shells</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Recon-ng Tool -->
        <div class="col tool-item" data-category="reconnaissance">
            <div class="card h-100">
                <div class="card-header bg-dark text-white d-flex justify-content-between">
                    <div>
                        <i class="bi bi-globe me-2"></i>
                        <strong>Recon-ng</strong>
                    </div>
                    <span class="badge bg-warning">Reconnaissance</span>
                </div>
                <div class="card-body">
                    <p class="card-text small">Framework de reconnaissance web open-source pour automatiser le processus de collecte d'informations.</p>
                    <div class="mb-3">
                        <label class="form-label fw-bold small">Options:</label>
                        <select class="form-select form-select-sm tool-option" data-tool="reconng">
                            {% for value, label in reconng_options %}
                            <option value="{{ value }}">{{ label }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold small">Domaine cible:</label>
                        <input type="text" class="form-control form-control-sm tool-target" placeholder="Domaine (ex: example.com)" data-tool="reconng">
                    </div>
                    <div class="d-grid gap-2">
                        <button class="btn btn-primary btn-sm run-tool" data-tool="reconng">
                            <i class="bi bi-play-fill me-1"></i>Exécuter
                        </button>
                        <button class="btn btn-outline-secondary btn-sm tool-doc-btn" data-bs-toggle="collapse" data-bs-target="#reconngDoc" aria-expanded="false">
                            <i class="bi bi-file-text me-1"></i>Documentation
                        </button>
                    </div>
                    <div class="collapse mt-3" id="reconngDoc">
                        <div class="card card-body bg-light small">
                            <h6>Documentation Recon-ng</h6>
                            <p>Recon-ng est un framework de reconnaissance web qui fournit une interface pour effectuer des opérations OSINT à grande échelle et stocker les résultats.</p>
                            <p><strong>Caractéristiques:</strong></p>
                            <ul>
                                <li>Interface similaire à Metasploit</li>
                                <li>Modules modulaires ciblés</li>
                                <li>Base de données intégrée</li>
                                <li>Génération de rapports</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- OWASP ZAP Tool -->
        <div class="col tool-item" data-category="web">
            <div class="card h-100">
                <div class="card-header bg-dark text-white d-flex justify-content-between">
                    <div>
                        <i class="bi bi-bug me-2"></i>
                        <strong>OWASP ZAP</strong>
                    </div>
                    <span class="badge bg-primary">Web</span>
                </div>
                <div class="card-body">
                    <p class="card-text small">Scanner de sécurité web intégré pour trouver des vulnérabilités dans les applications web.</p>
                    <div class="mb-3">
                        <label class="form-label fw-bold small">Options:</label>
                        <select class="form-select form-select-sm tool-option" data-tool="owaspzap">
                            {% for value, label in zap_options %}
                            <option value="{{ value }}">{{ label }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold small">URL cible:</label>
                        <input type="text" class="form-control form-control-sm tool-target" placeholder="URL (ex: https://example.com)" data-tool="owaspzap">
                    </div>
                    <div class="d-grid gap-2">
                        <button class="btn btn-primary btn-sm run-tool" data-tool="owaspzap">
                            <i class="bi bi-play-fill me-1"></i>Exécuter
                        </button>
                        <button class="btn btn-outline-secondary btn-sm tool-doc-btn" data-bs-toggle="collapse" data-bs-target="#owaspzapDoc" aria-expanded="false">
                            <i class="bi bi-file-text me-1"></i>Documentation
                        </button>
                    </div>
                    <div class="collapse mt-3" id="owaspzapDoc">
                        <div class="card card-body bg-light small">
                            <h6>Documentation OWASP ZAP</h6>
                            <p>OWASP Zed Attack Proxy (ZAP) est un scanner de sécurité web gratuit et open-source. C'est l'un des outils OWASP les plus actifs.</p>
                            <p><strong>Caractéristiques principales:</strong></p>
                            <ul>
                                <li>Tests d'intrusion automatiques</li>
                                <li>Proxy d'interception</li>
                                <li>Spider automatisé</li>
                                <li>Scanner de vulnérabilités</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- John the Ripper Tool -->
        <div class="col tool-item" data-category="password">
            <div class="card h-100">
                <div class="card-header bg-dark text-white d-flex justify-content-between">
                    <div>
                        <i class="bi bi-key me-2"></i>
                        <strong>John the Ripper</strong>
                    </div>
                    <span class="badge bg-secondary">Mot de passe</span>
                </div>
                <div class="card-body">
                    <p class="card-text small">Outil de craquage de mot de passe rapide et flexible.</p>
                    <div class="mb-3">
                        <label class="form-label fw-bold small">Options:</label>
                        <select class="form-select form-select-sm tool-option" data-tool="john">
                            {% for value, label in john_options %}
                            <option value="{{ value }}">{{ label }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold small">Fichier hash:</label>
                        <input type="text" class="form-control form-control-sm tool-target" placeholder="Chemin fichier (ex: hashes.txt)" data-tool="john">
                    </div>
                    <div class="d-grid gap-2">
                        <button class="btn btn-primary btn-sm run-tool" data-tool="john">
                            <i class="bi bi-play-fill me-1"></i>Exécuter
                        </button>
                        <button class="btn btn-outline-secondary btn-sm tool-doc-btn" data-bs-toggle="collapse" data-bs-target="#johnDoc" aria-expanded="false">
                            <i class="bi bi-file-text me-1"></i>Documentation
                        </button>
                    </div>
                    <div class="collapse mt-3" id="johnDoc">
                        <div class="card card-body bg-light small">
                            <h6>Documentation John the Ripper</h6>
                            <p>John the Ripper est un craqueur de mot de passe rapide, disponible pour de nombreux systèmes d'exploitation.</p>
                            <p><strong>Caractéristiques:</strong></p>
                            <ul>
                                <li>Détecte automatiquement les types de hash</li>
                                <li>Personnalisation des règles de craquage</li>
                                <li>Prise en charge de nombreux formats de hash</li>
                                <li>Mode incrémental pour bruteforce</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Hashcat Tool -->
        <div class="col tool-item" data-category="password">
            <div class="card h-100">
                <div class="card-header bg-dark text-white d-flex justify-content-between">
                    <div>
                        <i class="bi bi-key me-2"></i>
                        <strong>Hashcat</strong>
                    </div>
                    <span class="badge bg-secondary">Mot de passe</span>
                </div>
                <div class="card-body">
                    <p class="card-text small">Outil avancé de récupération de mot de passe utilisant la puissance du CPU/GPU.</p>
                    <div class="mb-3">
                        <label class="form-label fw-bold small">Options:</label>
                        <select class="form-select form-select-sm tool-option" data-tool="hashcat">
                            {% for value, label in hashcat_options %}
                            <option value="{{ value }}">{{ label }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold small">Fichier hash:</label>
                        <input type="text" class="form-control form-control-sm tool-target" placeholder="Chemin fichier (ex: hashes.txt)" data-tool="hashcat">
                    </div>
                    <div class="d-grid gap-2">
                        <button class="btn btn-primary btn-sm run-tool" data-tool="hashcat">
                            <i class="bi bi-play-fill me-1"></i>Exécuter
                        </button>
                        <button class="btn btn-outline-secondary btn-sm tool-doc-btn" data-bs-toggle="collapse" data-bs-target="#hashcatDoc" aria-expanded="false">
                            <i class="bi bi-file-text me-1"></i>Documentation
                        </button>
                    </div>
                    <div class="collapse mt-3" id="hashcatDoc">
                        <div class="card card-body bg-light small">
                            <h6>Documentation Hashcat</h6>
                            <p>Hashcat est le craqueur de mot de passe le plus rapide du monde, prenant en charge cinq modes d'attaque uniques.</p>
                            <p><strong>Caractéristiques:</strong></p>
                            <ul>
                                <li>Plusieurs modes d'attaque</li>
                                <li>Utilisation GPU optimisée</li>
                                <li>Support pour +300 algorithmes de hachage</li>
                                <li>Règles de mangling intégrées</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Aircrack-ng Tool -->
        <div class="col tool-item" data-category="wireless">
            <div class="card h-100">
                <div class="card-header bg-dark text-white d-flex justify-content-between">
                    <div>
                        <i class="bi bi-wifi me-2"></i>
                        <strong>Aircrack-ng</strong>
                    </div>
                    <span class="badge bg-info">Sans Fil</span>
                </div>
                <div class="card-body">
                    <p class="card-text small">Suite complète d'outils pour évaluer la sécurité des réseaux WiFi.</p>
                    <div class="mb-3">
                        <label class="form-label fw-bold small">Options:</label>
                        <select class="form-select form-select-sm tool-option" data-tool="aircrack">
                            {% for value, label in aircrack_options %}
                            <option value="{{ value }}">{{ label }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold small">Interface/Fichier:</label>
                        <input type="text" class="form-control form-control-sm tool-target" placeholder="Interface/Fichier (ex: wlan0 ou capture.cap)" data-tool="aircrack">
                    </div>
                    <div class="d-grid gap-2">
                        <button class="btn btn-primary btn-sm run-tool" data-tool="aircrack">
                            <i class="bi bi-play-fill me-1"></i>Exécuter
                        </button>
                        <button class="btn btn-outline-secondary btn-sm tool-doc-btn" data-bs-toggle="collapse" data-bs-target="#aircrackDoc" aria-expanded="false">
                            <i class="bi bi-file-text me-1"></i>Documentation
                        </button>
                    </div>
                    <div class="collapse mt-3" id="aircrackDoc">
                        <div class="card card-body bg-light small">
                            <h6>Documentation Aircrack-ng</h6>
                            <p>Aircrack-ng est une suite d'outils pour l'évaluation de la sécurité WiFi qui se concentre sur différents domaines de la sécurité WiFi.</p>
                            <p><strong>Composants principaux:</strong></p>
                            <ul>
                                <li>Monitoring: Capture de paquets</li>
                                <li>Attaque: Injecter et créer du trafic</li>
                                <li>Test: Vérifier les vulnérabilités WiFi</li>
                                <li>Cracking: Cassage WEP et WPA/WPA2-PSK</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Wifite Tool -->
        <div class="col tool-item" data-category="wireless">
            <div class="card h-100">
                <div class="card-header bg-dark text-white d-flex justify-content-between">
                    <div>
                        <i class="bi bi-wifi me-2"></i>
                        <strong>Wifite</strong>
                    </div>
                    <span class="badge bg-info">Sans Fil</span>
                </div>
                <div class="card-body">
                    <p class="card-text small">Outil automatisé d'attaque sans fil pour auditer plusieurs réseaux WiFi.</p>
                    <div class="mb-3">
                        <label class="form-label fw-bold small">Options:</label>
                        <select class="form-select form-select-sm tool-option" data-tool="wifite">
                            {% for value, label in wifite_options %}
                            <option value="{{ value }}">{{ label }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold small">Interface:</label>
                        <input type="text" class="form-control form-control-sm tool-target" placeholder="Interface (ex: wlan0)" data-tool="wifite">
                    </div>
                    <div class="d-grid gap-2">
                        <button class="btn btn-primary btn-sm run-tool" data-tool="wifite">
                            <i class="bi bi-play-fill me-1"></i>Exécuter
                        </button>
                        <button class="btn btn-outline-secondary btn-sm tool-doc-btn" data-bs-toggle="collapse" data-bs-target="#wifiteDoc" aria-expanded="false">
                            <i class="bi bi-file-text me-1"></i>Documentation
                        </button>
                    </div>
                    <div class="collapse mt-3" id="wifiteDoc">
                        <div class="card card-body bg-light small">
                            <h6>Documentation Wifite</h6>
                            <p>Wifite est conçu pour attaquer plusieurs réseaux WiFi de manière automatisée. Il utilise diverses méthodes d'attaque contre différents protocoles.</p>
                            <p><strong>Caractéristiques:</strong></p>
                            <ul>
                                <li>Attaques WEP (multiples méthodes)</li>
                                <li>Attaques WPA/WPA2 par dictionnaire</li>
                                <li>Attaques WPS</li>
                                <li>Détection automatique d'interface</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Metasploit Framework Tool -->
        <div class="col tool-item" data-category="exploitation">
            <div class="card h-100">
                <div class="card-header bg-dark text-white d-flex justify-content-between">
                    <div>
                        <i class="bi bi-code-square me-2"></i>
                        <strong>Metasploit</strong>
                    </div>
                    <span class="badge bg-danger">Exploitation</span>
                </div>
                <div class="card-body">
                    <p class="card-text small">Framework d'exploitation avancé pour développer, tester et exécuter des exploits.</p>
                    <div class="mb-3">
                        <label class="form-label fw-bold small">Options:</label>
                        <select class="form-select form-select-sm tool-option" data-tool="metasploit">
                            {% for value, label in metasploit_options %}
                            <option value="{{ value }}">{{ label }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold small">RHOST/RHOSTS:</label>
                        <input type="text" class="form-control form-control-sm tool-target" placeholder="Cible (ex: 192.168.1.10)" data-tool="metasploit">
                    </div>
                    <div class="d-grid gap-2">
                        <button class="btn btn-primary btn-sm run-tool" data-tool="metasploit">
                            <i class="bi bi-play-fill me-1"></i>Exécuter
                        </button>
                        <button class="btn btn-outline-secondary btn-sm tool-doc-btn" data-bs-toggle="collapse" data-bs-target="#metasploitDoc" aria-expanded="false">
                            <i class="bi bi-file-text me-1"></i>Documentation
                        </button>
                    </div>
                    <div class="collapse mt-3" id="metasploitDoc">
                        <div class="card card-body bg-light small">
                            <h6>Documentation Metasploit</h6>
                            <p>Metasploit Framework est l'outil d'exploitation le plus utilisé au monde. Il fournit l'infrastructure, le contenu et les outils pour réaliser des tests de pénétration.</p>
                            <p><strong>Composants principaux:</strong></p>
                            <ul>
                                <li>Modules d'exploitation</li>
                                <li>Modules auxiliaires (scanners)</li>
                                <li>Payloads (charges utiles)</li>
                                <li>Post-exploitation</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Wireshark Tool -->
        <div class="col tool-item" data-category="reconnaissance">
            <div class="card h-100">
                <div class="card-header bg-dark text-white d-flex justify-content-between">
                    <div>
                        <i class="bi bi-search me-2"></i>
                        <strong>Wireshark</strong>
                    </div>
                    <span class="badge bg-warning">Reconnaissance</span>
                </div>
                <div class="card-body">
                    <p class="card-text small">Analyseur de protocole réseau pour capturer et inspecter le trafic réseau en temps réel.</p>
                    <div class="mb-3">
                        <label class="form-label fw-bold small">Options:</label>
                        <select class="form-select form-select-sm tool-option" data-tool="wireshark">
                             {% for value, label in wireshark_options %}
                            <option value="{{ value }}">{{ label }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold small">Paramètre:</label>
                        <input type="text" class="form-control form-control-sm tool-target" placeholder="Cible (ex: eth0 ou capture.pcap)" data-tool="wireshark">
                    </div>
                    <div class="d-grid gap-2">
                        <button class="btn btn-primary btn-sm run-tool" data-tool="wireshark">
                            <i class="bi bi-play-fill me-1"></i>Exécuter
                        </button>
                        <button class="btn btn-outline-secondary btn-sm tool-doc-btn" data-bs-toggle="collapse" data-bs-target="#wiresharkDoc" aria-expanded="false">
                            <i class="bi bi-file-text me-1"></i>Documentation
                        </button>
                    </div>
                    <div class="collapse mt-3" id="wiresharkDoc">
                        <div class="card card-body bg-light small">
                            <h6>Documentation Wireshark</h6>
                            <p>Wireshark est l'analyseur de protocole réseau le plus populaire au monde, utilisé pour le dépannage réseau, l'analyse, développement et éducation.</p>
                            <p><strong>Fonctionnalités:</strong></p>
                            <ul>
                                <li>Inspection profonde des centaines de protocoles</li>
                                <li>Capture en direct et analyse hors ligne</li>
                                <li>Filtres d'affichage puissants</li>
                                <li>Reconstruction et visualisation de flux TCP</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ghidra Tool -->
        <div class="col tool-item" data-category="reverse">
            <div class="card h-100">
                <div class="card-header bg-dark text-white d-flex justify-content-between">
                    <div>
                        <i class="bi bi-file-earmark-code me-2"></i>
                        <strong>Ghidra</strong>
                    </div>
                    <span class="badge bg-success">Rétro-Ingénierie</span>
                </div>
                <div class="card-body">
                    <p class="card-text small">Outil de rétro-ingénierie développé par la NSA pour l'analyse de logiciels.</p>
                    <div class="mb-3">
                        <label class="form-label fw-bold small">Options:</label>
                        <select class="form-select form-select-sm tool-option" data-tool="ghidra">
                            {% for value, label in ghidra_options %}
                            <option value="{{ value }}">{{ label }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold small">Fichier binaire:</label>
                        <input type="text" class="form-control form-control-sm tool-target" placeholder="Chemin du fichier binaire" data-tool="ghidra">
                    </div>
                    <div class="d-grid gap-2">
                        <button class="btn btn-primary btn-sm run-tool" data-tool="ghidra">
                            <i class="bi bi-play-fill me-1"></i>Exécuter
                        </button>
                        <button class="btn btn-outline-secondary btn-sm tool-doc-btn" data-bs-toggle="collapse" data-bs-target="#ghidraDoc" aria-expanded="false">
                            <i class="bi bi-file-text me-1"></i>Documentation
                        </button>
                    </div>
                    <div class="collapse mt-3" id="ghidraDoc">
                        <div class="card card-body bg-light small">
                            <h6>Documentation Ghidra</h6>
                            <p>Ghidra est un framework de rétro-ingénierie logicielle open source développé par la NSA. Il permet d'analyser le code compilé sur diverses plateformes.</p>
                            <p><strong>Fonctionnalités:</strong></p>
                            <ul>
                                <li>Désassembleur et décompilateur</li>
                                <li>Support pour de nombreuses architectures</li>
                                <li>Collaboration en temps réel</li>
                                <li>Extensible via scripts et plugins</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- BeEF Tool -->
        <div class="col tool-item" data-category="exploitation">
            <div class="card h-100">
                <div class="card-header bg-dark text-white d-flex justify-content-between">
                    <div>
                        <i class="bi bi-globe me-2"></i>
                        <strong>BeEF</strong>
                    </div>
                    <span class="badge bg-danger">Exploitation</span>
                </div>
                <div class="card-body">
                    <p class="card-text small">Framework de test de pénétration qui se concentre sur le navigateur web comme vecteur d'attaque.</p>
                    <div class="mb-3">
                        <label class="form-label fw-bold small">Options:</label>
                        <select class="form-select form-select-sm tool-option" data-tool="beef">
                             {% for value, label in beef_options %}
                            <option value="{{ value }}">{{ label }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold small">Paramètre:</label>
                        <input type="text" class="form-control form-control-sm tool-target" placeholder="Valeur du paramètre" data-tool="beef">
                    </div>
                    <div class="d-grid gap-2">
                        <button class="btn btn-primary btn-sm run-tool" data-tool="beef">
                            <i class="bi bi-play-fill me-1"></i>Exécuter
                        </button>
                        <button class="btn btn-outline-secondary btn-sm tool-doc-btn" data-bs-toggle="collapse" data-bs-target="#beefDoc" aria-expanded="false">
                            <i class="bi bi-file-text me-1"></i>Documentation
                        </button>
                    </div>
                    <div class="collapse mt-3" id="beefDoc">
                        <div class="card card-body bg-light small">
                            <h6>Documentation BeEF</h6>
                            <p>Le Browser Exploitation Framework (BeEF) est un outil de test d'intrusion qui se concentre sur le navigateur web comme vecteur d'attaque.</p>
                            <p><strong>Fonctionnalités:</strong></p>
                            <ul>
                                <li>Hook de navigateurs via XSS</li>
                                <li>Modules d'exploitation du navigateur</li>
                                <li>Intégration avec Metasploit</li>
                                <li>Social engineering via le navigateur</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Snort Tool -->
        <div class="col tool-item" data-category="intrusion">
            <div class="card h-100">
                <div class="card-header bg-dark text-white d-flex justify-content-between">
                    <div>
                        <i class="bi bi-shield-check me-2"></i>
                        <strong>Snort</strong>
                    </div>
                    <span class="badge bg-primary">Détection d'intrusion</span>
                </div>
                <div class="card-body">
                    <p class="card-text small">Système de détection et de prévention d'intrusion réseau open source.</p>
                    <div class="mb-3">
                        <label class="form-label fw-bold small">Options:</label>
                        <select class="form-select form-select-sm tool-option" data-tool="snort">
                             {% for value, label in snort_options %}
                            <option value="{{ value }}">{{ label }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold small">Paramètre:</label>
                        <input type="text" class="form-control form-control-sm tool-target" placeholder="Valeur du paramètre (ex: eth0)" data-tool="snort">
                    </div>
                    <div class="d-grid gap-2">
                        <button class="btn btn-primary btn-sm run-tool" data-tool="snort">
                            <i class="bi bi-play-fill me-1"></i>Exécuter
                        </button>
                        <button class="btn btn-outline-secondary btn-sm tool-doc-btn" data-bs-toggle="collapse" data-bs-target="#snortDoc" aria-expanded="false">
                            <i class="bi bi-file-text me-1"></i>Documentation
                        </button>
                    </div>
                    <div class="collapse mt-3" id="snortDoc">
                        <div class="card card-body bg-light small">
                            <h6>Documentation Snort</h6>
                            <p>Snort est un système de détection d'intrusion réseau (NIDS) open source capable d'analyser le trafic en temps réel et de consigner les paquets.</p>
                            <p><strong>Fonctionnalités:</strong></p>
                            <ul>
                                <li>Analyse de protocole</li>
                                <li>Recherche/correspondance de contenu</li>
                                <li>Détection d'anomalies</li>
                                <li>Prévention d'intrusion</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tool Interface -->
    <div class="row mt-4">
        <div class="col-lg-12">
            <div class="card">
                <div class="card-header bg-dark text-white d-flex justify-content-between align-items-center">
                    <div>
                        <i class="bi bi-terminal me-2"></i>
                        <span id="activeTool">Terminal</span>
                    </div>
                    <div>
                        <button class="btn btn-sm btn-outline-light" id="clearTerminalBtn">
                            <i class="bi bi-eraser me-1"></i>Effacer
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-lg-8">
                            <div class="terminal bg-dark text-light p-3 rounded mb-3" id="terminalOutput" style="height: 400px; overflow-y: auto; font-family: 'Courier New', monospace;">
                                {% if nikto_raw_output %}
                                    <div class="text-success">{{ nikto_raw_output|linebreaksbr }}</div>
                                {% else %}
                                    <div class="text-success">Terminal prêt. Sélectionnez un outil et cliquez sur Exécuter pour commencer.</div>
                                {% endif %}
                            </div>

                            <div class="input-group mb-3">
                                <input type="text" class="form-control font-monospace" id="commandInput" placeholder="Entrez une commande personnalisée...">
                                <button class="btn btn-primary" type="button" id="runCommandBtn">
                                    <i class="bi bi-play-fill me-1"></i>Exécuter
                                </button>
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <ul class="nav nav-tabs" id="resultsTabs" role="tablist">
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link active" id="structured-tab" data-bs-toggle="tab" data-bs-target="#structuredResults" type="button" role="tab">Résultats Structurés</button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="raw-tab" data-bs-toggle="tab" data-bs-target="#rawResults" type="button" role="tab">Résultats Bruts</button>
                                </li>
                            </ul>
                            <div class="tab-content p-3 border border-top-0 rounded-bottom" style="height: 400px; overflow-y: auto;">
                                <div class="tab-pane fade show active" id="structuredResults" role="tabpanel">
                                    <table class="table table-sm table-hover" id="resultsTable">
                                        <thead>
                                            <tr>
                                                <th>Type</th>
                                                <th>Cible</th>
                                                <th>Sévérité</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {% if structured_results %}
                                                {% for result in structured_results %}
                                                    <tr>
                                                        <td>{{ result.option }}</td> <!-- Ou un champ spécifique comme 'type' si tu en as un -->
                                                        <td>{{ result.target_hostname }}:{{ result.target_port }}</td>
                                                        <td>
                                                            {% if 'critical' in result.vulnerability|lower %}
                                                                <span class="badge bg-danger">Critique</span>
                                                            {% elif 'medium' in result.vulnerability|lower %}
                                                                <span class="badge bg-warning text-dark">Moyenne</span>
                                                            {% else %}
                                                                <span class="badge bg-secondary">Faible</span>
                                                            {% endif %}
                                                        </td>
                                                        <td>
                                                            <button class="btn btn-sm btn-outline-secondary"
                                                                    data-bs-toggle="modal"
                                                                    data-bs-target="#resultDetailModal"
                                                                    onclick="showResultDetails('{{ result.id }}')">
                                                                Voir
                                                            </button>
                                                        </td>
                                                    </tr>
                                                {% endfor %}
                                            {% else %}
                                                <tr>
                                                    <td colspan="4" class="text-center text-muted">Aucun résultat disponible</td>
                                                </tr>
                                            {% endif %}
                                        </tbody>
                                    </table>
                                </div>

                                <div class="tab-pane fade" id="rawResults" role="tabpanel">
                                    <div class="small" id="rawResultsContent">
                                        {% if nikto_raw_output %}
                                            <pre>{{ nikto_raw_output }}</pre>
                                        {% else %}
                                            <div class="text-muted fst-italic">Exécutez un outil pour voir les résultats bruts</div>
                                        {% endif %}
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

 <!-- Historique des Analyses -->
<div class="row mt-4">
    <div class="col-lg-12">
        <div class="card">
            <div class="card-header bg-dark text-white">
                <i class="bi bi-clock-history me-2"></i>
                <span>Historique des Analyses</span>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-striped table-hover" id="historyTable">
                        <thead>
                            <tr>
                                <th>Date/Heure</th>
                                <th>Outil</th>
                                <th>Commande</th>
                                <th>Cible</th>
                                <th>Résultats</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% if scans_history %}
                                {% for scan in scans_history %}
                                    <tr>
                                        <td>{{ scan.start_time|date:"d/m/Y H:i" }}</td>
                                        <td>{{ scan.tool }}</td>
                                        <td>
                                            {% if scan.tool == 'NIKTO' %}
                                                nikto -h {{ scan.project.target_url|default:scan.project.target_ip }}
                                            {% else %}
                                                Commande personnalisée
                                            {% endif %}
                                        </td>
                                        <td>{{ scan.project.target_url|default:scan.project.target_ip }}</td>
                                        <td>
                                            {% if scan.status == "completed" %}
                                                Terminé
                                            {% elif scan.status == "running" %}
                                                En cours...
                                            {% else %}
                                                {{ scan.status }}
                                            {% endif %}
                                        </td>
                                        <td>
                                            <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#modalScan{{ scan.id }}">
                                                <i class="bi bi-eye"></i> Voir
                                            </button>
                                        </td>
                                    </tr>

                                    <!-- Modal Détails du Scan -->
                                    <div class="modal fade" id="modalScan{{ scan.id }}" tabindex="-1" aria-labelledby="modalScanLabel{{ scan.id }}" aria-hidden="true">
                                        <div class="modal-dialog modal-lg modal-dialog-scrollable">
                                            <div class="modal-content">
                                                <div class="modal-header bg-dark text-white">
                                                    <h5 class="modal-title" id="modalScanLabel{{ scan.id }}">
                                                        Détails du scan - {{ scan.tool }} ({{ scan.start_time|date:"d/m/Y H:i" }})
                                                    </h5>
                                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                                                </div>
                                                <div class="modal-body">
                                                    {% with result=scan.niktoresult_set.first %}
                                                        {% if result %}
                                                            <p><strong>Cible :</strong> {{ result.uri }}</p>
                                                            <p><strong>Serveur :</strong> {{ result.server }}</p>
                                                            <p><strong>SSL Subject :</strong> {{ result.ssl_subject }}</p>
                                                            <p><strong>SSL Issuer :</strong> {{ result.ssl_issuer }}</p>
                                                            <p><strong>SSL AltNames :</strong> {{ result.ssl_altnames }}</p>
                                                            <p><strong>SSL Cipher :</strong> {{ result.ssl_cipher }}</p>
                                                            <p><strong>Powered By :</strong> {{ result.x_powered_by }}</p>
                                                            <p><strong>Frame Options :</strong> {{ result.x_frame_options }}</p>
                                                            <p><strong>robots.txt :</strong><br><pre>{{ result.robots_txt_entries }}</pre></p>
                                                            <p><strong>Fichiers index :</strong><br><pre>{{ result.index_files }}</pre></p>
                                                            <hr>
                                                            <h6>Sortie brute :</h6>
                                                            <pre style="white-space: pre-wrap;">{{ result.description }}</pre>
                                                        {% else %}
                                                            <p class="text-muted">Aucun résultat détaillé trouvé pour ce scan.</p>
                                                        {% endif %}
                                                    {% endwith %}
                                                </div>
                                                <div class="modal-footer">
                                                    {% with result=scan.niktoresult_set.first %}
                                                        {% if result and result.id %}
                                                            <a href="{% url 'nikto_report_pdf' result.id %}" class="btn btn-success" target="_blank">
                                                                <i class="bi bi-file-earmark-pdf"></i> Générer le rapport
                                                            </a>
                                                        {% else %}
                                                            <span class="text-muted">Aucun rapport disponible</span>
                                                        {% endif %}
                                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
                                                    {% endwith %}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                {% endfor %}
                            {% else %}
                                <tr>
                                    <td colspan="6" class="text-center text-muted">Aucun historique disponible</td>
                                </tr>
                            {% endif %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>


</div>

<!-- Modal pour visualiser les détails du scan (actuellement spécifique à Nikto) -->
<div class="modal fade" id="resultDetailModal" tabindex="-1">
    <div class="modal-dialog modal-lg modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header bg-dark text-white">
                <h5 class="modal-title">
                    <i class="bi bi-shield-check me-2"></i> Rapport de Scan - Nikto
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
            </div>
            <div class="modal-body">
                <p class="result-details mb-4 text-muted">Ce rapport affiche les détails spécifiques au scan effectué avec l'outil <strong>Nikto</strong>.</p>

                <!-- Section : Détails du scan Nikto -->
                <h6 class="fw-bold">Détails du scan</h6>
                <table class="table table-bordered table-sm mb-4">
                    <tr><th>Hostname</th><td id="modal-hostname"></td></tr>
                    <tr><th>Port</th><td id="modal-port"></td></tr>
                    <tr><th>Serveur</th><td id="modal-server"></td></tr>
                    <tr><th>SSL Subject</th><td id="modal-ssl-subject"></td></tr>
                    <tr><th>SSL Issuer</th><td id="modal-ssl-issuer"></td></tr>
                    <tr><th>SSL AltNames</th><td id="modal-ssl-altnames"></td></tr>
                    <tr><th>SSL Cipher</th><td id="modal-ssl-cipher"></td></tr>
                    <tr><th>Début du scan</th><td id="modal-start-time"></td></tr>
                    <tr><th>Private IPs Disclosed</th><td id="modal-private-ips"></td></tr>
                    <tr><th>Uncommon Headers</th><td id="modal-uncommon-headers"></td></tr>
                    <tr><th>Alt Svc</th><td id="modal-alt-svc"></td></tr>
                    <tr><th>IP in Cookie</th><td id="modal-ip-in-cookie"></td></tr>
                    <tr><th>Redirection root</th><td id="modal-redirected-root"></td></tr>
                    <tr><th>X-Powered-By</th><td id="modal-x-powered-by"></td></tr>
                    <tr><th>X-Frame-Options</th><td id="modal-x-frame-options"></td></tr>
                    <tr><th>Link Headers</th><td id="modal-link-headers"></td></tr>
                    <tr><th>Robots.txt</th><td id="modal-robots-txt"></td></tr>
                    <tr><th>Index Files</th><td id="modal-index-files"></td></tr>
                    <tr><th>Scan terminé</th><td id="modal-scan-completed"></td></tr>
                    <tr><th>Total requêtes</th><td id="modal-total-requests"></td></tr>
                    <tr><th>% Complété</th><td id="modal-percent-complete"></td></tr>
                    <tr><th>Temps estimé restant</th><td id="modal-estimated-time"></td></tr>
                    <tr><th>Date création</th><td id="modal-created-at"></td></tr>
                </table>

                <!-- Section : Sortie brute -->
                <h6 class="fw-bold">Sortie brute</h6>
                <pre class="bg-dark text-light p-3 rounded result-output" style="max-height: 400px; overflow: auto;"></pre>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Sélection des éléments
    const toolsList = document.getElementById('toolsList');
    const categoryButtons = document.querySelectorAll('[data-category]');
    const toolSearch = document.getElementById('toolSearch');
    const terminalOutput = document.getElementById('terminalOutput');
    const commandInput = document.getElementById('commandInput');
    const runCommandBtn = document.getElementById('runCommandBtn');
    const clearTerminalBtn = document.getElementById('clearTerminalBtn');
    const activeTool = document.getElementById('activeTool');
    const resultsTable = document.querySelector('#resultsTable tbody');
    const rawResultsContent = document.getElementById('rawResultsContent');
    const historyTable = document.querySelector('#historyTable tbody');
    
    // Fonction pour filtrer les outils par catégorie
    categoryButtons.forEach(button => {
        button.addEventListener('click', function() {
            // Retirer la classe active de tous les boutons
            categoryButtons.forEach(btn => btn.classList.remove('active'));
            // Ajouter la classe active au bouton cliqué
            this.classList.add('active');
            
            const category = this.getAttribute('data-category');
            const tools = toolsList.querySelectorAll('.tool-item');
            
            tools.forEach(tool => {
                if (category === 'all' || tool.getAttribute('data-category') === category) {
                    tool.style.display = '';
                } else {
                    tool.style.display = 'none';
                }
            });
        });
    });
    
    // Fonction pour rechercher des outils
    toolSearch.addEventListener('input', function() {
        const searchTerm = this.value.toLowerCase();
        const tools = toolsList.querySelectorAll('.tool-item');
        
        tools.forEach(tool => {
            const toolName = tool.querySelector('strong').textContent.toLowerCase();
            const toolDesc = tool.querySelector('.card-text').textContent.toLowerCase();
            
            if (toolName.includes(searchTerm) || toolDesc.includes(searchTerm)) {
                tool.style.display = '';
            } else {
                tool.style.display = 'none';
            }
        });
    });
    
    // Fonction pour exécuter une commande personnalisée
    runCommandBtn.addEventListener('click', function() {
        const command = commandInput.value.trim();
        if (command) {
            executeCommand(command);
            commandInput.value = '';
        }
    });
    
    // Fonction pour effacer le terminal
    clearTerminalBtn.addEventListener('click', function() {
        terminalOutput.innerHTML = '<div class="text-success">Terminal effacé.</div>';
    });
    
    
    // Permettre d'utiliser Entrée dans la zone de commande
    commandInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            runCommandBtn.click();
        }
    });

});
function showResultDetails(scanId) {
    const niktoScans = JSON.parse(document.getElementById('nikto-results-data').textContent);
    const scan = niktoScans.find(s => s.id == scanId);
    if (!scan) return;

    document.getElementById('modal-hostname').textContent = scan.target_hostname || '';
    document.getElementById('modal-port').textContent = scan.target_port || '';
    document.getElementById('modal-server').textContent = scan.server || '';
    document.getElementById('modal-ssl-subject').textContent = scan.ssl_subject || '';
    document.getElementById('modal-ssl-issuer').textContent = scan.ssl_issuer || '';
    document.getElementById('modal-ssl-altnames').textContent = scan.ssl_altnames || '';
    document.getElementById('modal-ssl-cipher').textContent = scan.ssl_cipher || '';
    document.getElementById('modal-start-time').textContent = scan.start_time || '';
    document.getElementById('modal-private-ips').textContent = scan.private_ips_disclosed || '';
    document.getElementById('modal-uncommon-headers').textContent = scan.uncommon_headers || '';
    document.getElementById('modal-alt-svc').textContent = scan.alt_svc || '';
    document.getElementById('modal-ip-in-cookie').textContent = scan.ip_in_cookie || '';
    document.getElementById('modal-redirected-root').textContent = scan.redirected_root || '';
    document.getElementById('modal-x-powered-by').textContent = scan.x_powered_by || '';
    document.getElementById('modal-x-frame-options').textContent = scan.x_frame_options || '';
    document.getElementById('modal-link-headers').textContent = scan.link_headers || '';
    document.getElementById('modal-robots-txt').textContent = scan.robots_txt_entries || '';
    document.getElementById('modal-index-files').textContent = scan.index_files || '';
    document.getElementById('modal-scan-completed').textContent = scan.scan_completed ? "Oui" : "Non";
    document.getElementById('modal-total-requests').textContent = scan.total_requests || '';
    document.getElementById('modal-percent-complete').textContent = scan.percent_complete || '';
    document.getElementById('modal-estimated-time').textContent = scan.estimated_time_left || '';
    document.getElementById('modal-created-at').textContent = scan.created_at || '';
    document.getElementById('modal-description').textContent = scan.description || '';
}
</script>
{% endblock %}
